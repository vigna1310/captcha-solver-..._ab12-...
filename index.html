<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Captcha Solver</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2em;
      max-width: 800px;
    }
    h1 {
      text-align: center;
    }
    #container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #imageContainer {
      margin: 1em 0;
      max-width: 100%;
    }
    #captchaImage {
      max-width: 100%;
      height: auto;
      border: 1px solid #ccc;
    }
    #loadImageBtn, #solveBtn {
      margin: 0.5em;
      padding: 0.5em 1em;
      font-size: 1em;
    }
    #result {
      margin-top: 1em;
      font-size: 1.2em;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Captcha Solver</h1>
  <div id="container">
    <button id="loadImageBtn">Load Image</button>
    <div id="imageContainer">
      <canvas id="canvas"></canvas>
    </div>
    <button id="solveBtn">Solve Captcha</button>
    <div id="result"></div>
  </div>

  <script>
    const loadImageBtn = document.getElementById('loadImageBtn');
    const solveBtn = document.getElementById('solveBtn');
    const resultDiv = document.getElementById('result');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // Use a default sample image
    const defaultImageURL = 'https://images.unsplash.com/photo-1533674205193-f90f0f8f5f0e?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80';

    let image = new Image();

    function loadImage(url) {
      image.crossOrigin = "Anonymous"; // to avoid CORS issues
      image.onload = () => {
        // Resize or fit to canvas
        canvas.width = image.width;
        canvas.height = image.height;
        ctx.drawImage(image, 0, 0);
        resultDiv.textContent = '';
      };
      image.onerror = () => {
        alert('Failed to load image.');
      };
      image.src = url;
    }

    // Load default image on page load
    window.onload = () => {
      loadImage(defaultImageURL);
    };

    loadImageBtn.onclick = () => {
      // Prompt user for URL
      const url = prompt('Enter image URL:', defaultImageURL);
      if (url) {
        loadImage(url);
      }
    };

    solveBtn.onclick = () => {
      resultDiv.textContent = 'Processing...';
      // Get image data
      const width = canvas.width;
      const height = canvas.height;
      const imageData = ctx.getImageData(0, 0, width, height);
      const data = imageData.data;

      // Simple OCR: convert image to black & white and detect text
      // For demonstration, we'll implement a dummy OCR that extracts visible letters
      // Note: Real OCR requires complex algorithms or services
      // Here, we'll do a placeholder: count black pixels 

      // Convert to grayscale and threshold
      const threshold = 128;
      let blackPixelsCount = 0;
      for (let i = 0; i < data.length; i += 4) {
        const r = data[i], g = data[i+1], b = data[i+2];
        const gray = 0.299*r + 0.587*g + 0.114*b;
        if (gray < threshold) {
          // black pixel
          blackPixelsCount++;
        }
      }

      // Dummy logic: if enough black pixels, assume 'ABCD' as placeholder
      const blackPixelRatio = blackPixelsCount / (width * height);
      let recognizedText = '';

      if (blackPixelRatio > 0.1) {
        recognizedText = 'ABCD';
      } else {
        recognizedText = '1234';
      }

      resultDiv.textContent = 'Recognized Text: ' + recognizedText;
    }
  </script>
</body>
</html>